part(1). % change to part(2)

init([], []).
init([give(_,_,_)|Xs], Bs) :- init(Xs, Bs).
init([value(V,N)|Xs], Bs1) :-
    init(Xs, Bs),
    ( select(N-W, Bs, Bs0) -> Bs1 = [N-[V,W]|Bs0]
    ; Bs1 = [N-V|Bs]
    ).

give(N, V, Bs, [N-[V,W]|Bs1]) :- select(N-W, Bs, Bs1), !.
give(N, V, Bs, [N-V|Bs]).

pass(Rules, Bs, X) :-
    select(B-[V,W], Bs, Bs1), !,
    sort([V,W], [L,H]),
    ( part(1), L = 17, H = 61 -> X = B
    ; member(give(B,Bl,Bh), Rules),
      give(Bl, L, Bs1, Bs2),
      give(Bh, H, Bs2, Bs3),
      pass(Rules, Bs3, X)
    ), !.
pass(_, Bs, X) :- % part 2
    member(output0-A, Bs),
    member(output1-B, Bs),
    member(output2-C, Bs),
    X is A * B * C.

adv10(X) :- data(D), init(D, R), pass(D, R, X).

data([give(bot49,bot118,bot182),
      give(bot192,bot40,bot177),
      give(bot195,output4,bot130),
      give(bot176,bot32,bot168),
      give(bot152,bot98,bot36),
      give(bot99,bot194,bot171),
      value(61,bot49),
      give(bot109,bot137,bot82),
      give(bot57,bot150,bot185),
      give(bot117,bot70,bot189),
      give(bot87,bot145,bot26),
      give(bot104,bot20,bot153),
      give(bot14,bot203,bot162),
      give(bot76,bot80,bot67),
      give(bot80,bot159,bot183),
      give(bot0,bot99,bot167),
      give(bot13,bot35,bot129),
      give(bot74,bot177,bot108),
      give(bot5,bot189,bot27),
      give(bot28,output0,bot61),
      give(bot19,bot77,bot181),
      give(bot197,bot26,bot207),
      give(bot128,bot65,bot90),
      give(bot93,bot117,bot5),
      give(bot139,bot74,bot170),
      give(bot132,bot199,bot23),
      give(bot3,bot103,bot95),
      give(bot162,bot45,bot188),
      give(bot163,bot132,bot23),
      value(19,bot20),
      give(bot164,bot95,bot14),
      give(bot204,bot140,bot42),
      give(bot155,bot37,bot43),
      give(bot32,bot15,bot0),
      give(bot6,bot2,bot161),
      give(bot112,bot85,bot12),
      give(bot24,bot100,bot25),
      give(bot62,bot143,bot39),
      give(bot131,output11,bot159),
      give(bot166,bot81,bot163),
      give(bot209,output5,bot140),
      give(bot108,bot125,bot136),
      give(bot138,bot13,bot156),
      give(bot144,bot195,bot130),
      give(bot15,bot31,bot99),
      give(bot135,bot43,bot148),
      give(bot12,bot30,bot157),
      give(bot85,bot56,bot30),
      value(47,bot133),
      give(bot27,bot17,bot166),
      value(5,bot32),
      give(bot149,bot41,bot88),
      give(bot156,bot129,bot179),
      value(73,bot146),
      give(bot64,bot49,bot151),
      give(bot185,bot191,bot97),
      give(bot173,bot1,bot66),
      give(bot70,bot133,bot9),
      give(bot123,bot154,bot53),
      give(bot91,bot113,bot175),
      give(bot154,bot73,bot173),
      give(bot43,bot172,bot3),
      give(bot113,bot44,bot11),
      give(bot196,bot52,bot84),
      value(37,bot118),
      give(bot83,output9,bot56),
      give(bot150,bot111,bot191),
      give(bot60,bot19,bot141),
      value(23,bot143),
      give(bot198,bot127,bot87),
      give(bot44,bot193,bot48),
      give(bot7,bot139,bot178),
      give(bot143,output12,bot120),
      give(bot130,output1,output13),
      give(bot56,output10,bot101),
      give(bot30,bot101,bot190),
      give(bot67,bot183,bot33),
      give(bot92,bot167,bot113),
      give(bot115,bot197,bot199),
      give(bot69,bot131,bot80),
      give(bot100,bot136,bot25),
      give(bot11,bot48,bot201),
      give(bot186,bot6,bot29),
      give(bot17,bot54,bot81),
      give(bot122,bot64,bot200),
      value(71,bot176),
      give(bot103,bot33,bot57),
      give(bot31,bot122,bot194),
      give(bot29,bot161,bot79),
      give(bot95,bot57,bot203),
      give(bot171,bot109,bot193),
      give(bot51,bot106,bot19),
      give(bot48,bot206,bot192),
      give(bot127,bot168,bot145),
      give(bot36,bot128,bot90),
      value(3,bot64),
      give(bot22,output6,bot131),
      give(bot39,bot120,bot147),
      give(bot61,output17,bot195),
      give(bot194,bot200,bot109),
      give(bot180,bot5,bot72),
      give(bot86,bot164,bot119),
      give(bot65,bot28,bot121),
      give(bot68,bot123,bot184),
      give(bot63,bot58,bot196),
      give(bot98,bot157,bot36),
      give(bot157,bot190,bot128),
      give(bot18,bot126,bot7),
      give(bot79,bot124,bot154),
      give(bot40,bot55,bot186),
      give(bot188,bot96,bot152),
      give(bot165,bot175,bot18),
      give(bot142,bot79,bot123),
      give(bot81,bot114,bot163),
      give(bot78,output18,bot202),
      give(bot45,bot97,bot96),
      give(bot23,bot63,bot196),
      give(bot208,bot176,bot127),
      give(bot206,bot110,bot40),
      give(bot90,bot121,bot144),
      give(bot46,output16,bot28),
      give(bot167,bot171,bot44),
      give(bot147,bot78,bot89),
      give(bot116,bot60,bot2),
      give(bot105,bot87,bot197),
      give(bot133,bot160,bot149),
      give(bot42,bot22,bot69),
      give(bot137,bot138,bot134),
      give(bot136,bot142,bot68),
      give(bot75,output20,bot174),
      give(bot178,bot170,bot24),
      give(bot119,bot14,bot16),
      give(bot158,bot83,bot85),
      give(bot182,bot187,bot13),
      give(bot110,bot38,bot55),
      value(17,bot122),
      give(bot120,output2,bot78),
      value(59,bot31),
      give(bot89,bot202,bot107),
      give(bot184,bot53,bot71),
      give(bot153,bot180,bot72),
      give(bot106,bot107,bot77),
      value(43,bot34),
      give(bot58,bot18,bot52),
      give(bot111,bot174,bot158),
      give(bot200,bot151,bot137),
      give(bot10,bot12,bot98),
      give(bot148,bot3,bot164),
      give(bot47,bot59,bot155),
      give(bot169,bot69,bot76),
      give(bot38,bot179,bot116),
      value(2,bot15),
      value(13,bot93),
      give(bot203,bot185,bot45),
      give(bot72,bot27,bot166),
      give(bot101,output19,bot46),
      give(bot94,bot119,bot16),
      give(bot35,bot147,bot21),
      give(bot175,bot11,bot126),
      give(bot54,bot88,bot114),
      give(bot125,bot29,bot142),
      give(bot201,bot192,bot74),
      give(bot26,bot91,bot165),
      value(53,bot62),
      give(bot16,bot162,bot188),
      give(bot141,bot181,bot47),
      give(bot41,bot198,bot105),
      give(bot21,bot89,bot106),
      value(31,bot208),
      give(bot187,bot39,bot35),
      give(bot145,bot92,bot91),
      give(bot55,bot116,bot6),
      give(bot159,output8,bot8),
      value(11,bot70),
      give(bot50,bot155,bot135),
      give(bot2,bot141,bot102),
      give(bot168,bot0,bot92),
      give(bot189,bot9,bot17),
      give(bot53,bot173,bot71),
      give(bot129,bot21,bot51),
      give(bot52,bot7,bot84),
      give(bot172,bot67,bot103),
      give(bot33,bot205,bot150),
      give(bot37,bot76,bot172),
      give(bot190,bot46,bot65),
      give(bot199,bot207,bot63),
      give(bot179,bot51,bot60),
      give(bot20,bot93,bot180),
      give(bot34,bot208,bot198),
      give(bot151,bot182,bot138),
      give(bot71,bot66,bot94),
      give(bot160,bot34,bot41),
      give(bot170,bot108,bot100),
      give(bot4,bot42,bot169),
      give(bot77,bot204,bot4),
      give(bot161,bot102,bot124),
      give(bot177,bot186,bot125),
      give(bot181,bot4,bot59),
      give(bot97,bot112,bot10),
      give(bot134,bot156,bot38),
      give(bot205,bot75,bot111),
      give(bot1,bot148,bot86),
      give(bot146,bot104,bot153),
      give(bot174,output3,bot83),
      give(bot102,bot47,bot50),
      give(bot124,bot50,bot73),
      give(bot207,bot165,bot58),
      give(bot118,bot62,bot187),
      give(bot140,output7,bot22),
      give(bot8,output14,bot75),
      value(41,bot117),
      give(bot121,bot61,bot144),
      give(bot88,bot105,bot115),
      give(bot114,bot115,bot132),
      give(bot66,bot86,bot94),
      value(29,bot146),
      give(bot73,bot135,bot1),
      give(bot84,bot178,bot24),
      give(bot191,bot158,bot112),
      give(bot202,output15,bot209),
      give(bot183,bot8,bot205),
      value(7,bot160),
      give(bot126,bot201,bot139),
      give(bot107,bot209,bot204),
      give(bot59,bot169,bot37),
      value(67,bot104),
      give(bot9,bot149,bot54),
      give(bot82,bot134,bot110),
      give(bot25,bot68,bot184),
      give(bot193,bot82,bot206),
      give(bot96,bot10,bot152)]).
